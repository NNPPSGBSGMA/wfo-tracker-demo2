<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Medical Affairs, P&PS GBS - Attendance 2026</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <div class="login-logo">
                <h1>GMA, P&PS GBS</h1>
                <p>Attendance Tracker 2026 - Bangalore</p>
            </div>

            <div class="login-error" id="loginError">
                Invalid code or password. Please try again.
            </div>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="login-form-group">
                    <label for="loginCode">Enter Your 4-Letter Code:</label>
                    <input 
                        type="text" 
                        id="loginCode" 
                        class="code-input-field"
                        maxlength="4" 
                        placeholder="XXXX"
                        required
                        autocomplete="off"
                    >
                </div>

                <div class="login-form-group">
                    <label for="loginPassword">Password:</label>
                    <input 
                        type="password" 
                        id="loginPassword" 
                        placeholder="Enter your password"
                        required
                    >
                </div>

                <button type="submit" class="login-submit-btn">Login to Tracker</button>
            </form>

            <p class="login-info">Please enter your assigned 4-letter code and unique password</p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header">
            <div class="header-left">
                <h1>Global Medical Affairs, P&PS GBS</h1>
                <p>Office Attendance Tracker 2026</p>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-code" id="displayUserCode"></div>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>

        <div class="security-notice">
            ðŸ”’ <strong>Security Policy:</strong> You are logged in as <span id="securityUserCode" style="font-weight:bold;"></span>. You can ONLY view and edit your own attendance row. Select status from dropdown for each date.
        </div>

        <div class="admin-notice" id="adminNotice">
            ðŸ‘‘ <strong>Admin Access:</strong> You have administrator privileges. You can generate comprehensive reports for all team members.
        </div>

        <div class="security-violation" id="securityViolation">
            ðŸš¨ <strong>SECURITY VIOLATION DETECTED!</strong> You attempted to modify data that doesn't belong to you. This action has been blocked and logged.
        </div>

        <div class="success-message" id="successMessage">
            âœ“ Your attendance has been saved successfully!
        </div>

        <div class="action-bar">
            <div class="month-selector">
                <select id="monthSelector" onchange="changeMonth()">
                    <option value="0">January 2026</option>
                    <option value="1">February 2026</option>
                    <option value="2">March 2026</option>
                    <option value="3">April 2026</option>
                    <option value="4">May 2026</option>
                    <option value="5">June 2026</option>
                    <option value="6">July 2026</option>
                    <option value="7">August 2026</option>
                    <option value="8">September 2026</option>
                    <option value="9">October 2026</option>
                    <option value="10">November 2026</option>
                    <option value="11">December 2026</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <span class="pending-changes" id="pendingChanges" style="display: none;">
                    You have unsaved changes for <strong id="pendingUserCode"></strong>
                </span>
                <button class="submit-btn" id="submitBtn" onclick="submitAttendance()" disabled>
                    Submit My Attendance
                </button>
                <button class="report-btn" id="reportBtn" onclick="generateReport()" style="display: none;">
                    ðŸ“Š Generate Report
                </button>
                <button class="export-btn" onclick="exportToCSV()">
                    ðŸ“¥ Export to CSV
                </button>
            </div>
        </div>

        <div class="calendar-container">
            <table id="attendanceTable">
                <!-- Table will be generated by JavaScript -->
            </table>
        </div>

        <div class="stats" id="statsContainer" style="display: none;">
            <!-- Stats will be generated by JavaScript -->
        </div>

        <div class="holidays-section">
            <h3>GBS Holidays 2026 - National and Festival Holidays</h3>
            <div class="holidays-list">
                <div class="holiday-item">
                    <strong>15 January 2026</strong> (Thursday) - Makara Sankranti
                </div>
                <div class="holiday-item">
                    <strong>26 January 2026</strong> (Monday) - Republic Day
                </div>
                <div class="holiday-item">
                    <strong>19 March 2026</strong> (Thursday) - Ugadi Festival
                </div>
                <div class="holiday-item">
                    <strong>01 May 2026</strong> (Friday) - May Day
                </div>
                <div class="holiday-item">
                    <strong>28 May 2026</strong> (Thursday) - Bakrid
                </div>
                <div class="holiday-item">
                    <strong>14 September 2026</strong> (Monday) - Ganesh Chaturthi
                </div>
                <div class="holiday-item">
                    <strong>02 October 2026</strong> (Friday) - Gandhi Jayanti
                </div>
                <div class="holiday-item">
                    <strong>20 October 2026</strong> (Tuesday) - Ayudha Puja / Mahanavami
                </div>
                <div class="holiday-item">
                    <strong>10 November 2026</strong> (Tuesday) - Balipadyami / Deepavali
                </div>
                <div class="holiday-item">
                    <strong>25 December 2026</strong> (Friday) - Christmas
                </div>
            </div>
        </div>

        <div class="legend">
            <h3>Status Legend</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color wfo-color"></div>
                    <span><strong>WFO</strong> - Add Green shade, when you are in office</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color planned-color"></div>
                    <span><strong>Planned</strong> - Add Yellow, when you are in a plan to be in office for upcoming days or weeks</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color offsite-color"></div>
                    <span><strong>Offsite/All-day meeting</strong> - Add Purple, when you are in a Offsite/training session</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color travel-color"></div>
                    <span><strong>Onsite/travel</strong> - Add Blue, when you are in a business travel</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color leave-color"></div>
                    <span><strong>Leave</strong> - Add Pink, if you have planned or sick leave</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color holiday-color"></div>
                    <span><strong>Holiday/Weekend</strong> - No action needed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ðŸ“Š Comprehensive Attendance Report - 2026</h2>
                <span class="close" onclick="closeReportModal()">&times;</span>
            </div>
            <div id="reportContent">
                <!-- Report content will be generated here -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="export-btn" onclick="exportReportToCSV()">ðŸ“¥ Download Full Report (CSV)</button>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="script.js"></script>
</body>
</html>