<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Medical Affairs, P&PS GBS - Attendance 2026</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <h2>Global Medical Affairs - Sign In</h2>
        <div class="error-message" id="errorMessage"></div>
        <form class="login-form" onsubmit="handleLogin(event)">
            <div class="form-group">
                <label for="userCode">Enter Your User Code</label>
                <input
                    type="text"
                    id="userCode"
                    placeholder="XXXX"
                    required
                    maxlength="4"
                    minlength="4"
                    pattern="[a-zA-Z]{4}"
                    title="Please enter exactly 4 letters"
                    autocomplete="off"
                >
                <div class="form-hint">Enter your 4-letter Novo Nordisk code (e.g., AJLO, NRVL)</div>
            </div>
            <button type="submit" class="login-btn">Sign In</button>
        </form>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header">
            <div class="header-left">
                <h1>Global Medical Affairs, P&PS GBS</h1>
                <p>Office Attendance Tracker 2026</p>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-code" id="displayUserCode"></div>
                    <div class="user-email" id="userEmail"></div>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="security-notice">
            üîí <strong>Security Policy:</strong> You are logged in as <span id="securityUserCode" style="font-weight:bold;"></span>. You can ONLY view and edit your own attendance row. Select status from dropdown for each date.
        </div>

        <div class="admin-notice" id="adminNotice">
            üëë <strong>Admin Access:</strong> You have administrator privileges. You can generate comprehensive reports for all team members.
        </div>

        <div class="security-violation" id="securityViolation">
            üö® <strong>SECURITY VIOLATION DETECTED!</strong> You attempted to modify data that doesn't belong to you. This action has been blocked and logged.
        </div>

        <div class="success-message" id="successMessage">
            ‚úì Your attendance has been saved successfully!
        </div>

        <div class="warning-message" id="warningMessage">
            ‚ö†Ô∏è You can only edit your own attendance data!
        </div>

        <div class="action-bar">
            <div class="month-selector">
                <select id="monthSelector" onchange="changeMonth()">
                    <option value="0">January 2026</option>
                    <option value="1">February 2026</option>
                    <option value="2">March 2026</option>
                    <option value="3">April 2026</option>
                    <option value="4">May 2026</option>
                    <option value="5">June 2026</option>
                    <option value="6">July 2026</option>
                    <option value="7">August 2026</option>
                    <option value="8">September 2026</option>
                    <option value="9">October 2026</option>
                    <option value="10">November 2026</option>
                    <option value="11">December 2026</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px;">
                <span class="pending-changes" id="pendingChanges" style="display: none;">
                    You have unsaved changes for <strong id="pendingUserCode"></strong>
                </span>
                <button class="submit-btn" id="submitBtn" onclick="submitAttendance()" disabled>
                    Submit My Attendance
                </button>
                <button class="report-btn" id="reportBtn" onclick="generateReport()">
                    üìä Generate Report
                </button>
                <button class="export-btn" onclick="exportToCSV()">
                    üì• Export to CSV
                </button>
            </div>
        </div>

        <div class="calendar-container">
            <table id="attendanceTable">
                <!-- Table will be generated by JavaScript -->
            </table>
        </div>

        <div class="stats" id="statsContainer">
            <!-- Stats will be generated by JavaScript -->
        </div>

        <div class="holidays-section">
            <h3>GBS Holidays 2026 - National and Festival Holidays</h3>
            <div class="holidays-list">
                <div class="holiday-item">
                    <strong>15 January 2026</strong> (Thursday)<br>
                    Makara Sankranti
                </div>
                <div class="holiday-item">
                    <strong>26 January 2026</strong> (Monday)<br>
                    Republic Day
                </div>
                <div class="holiday-item">
                    <strong>19 March 2026</strong> (Thursday)<br>
                    Ugadi Festival
                </div>
                <div class="holiday-item">
                    <strong>01 May 2026</strong> (Friday)<br>
                    May Day
                </div>
                <div class="holiday-item">
                    <strong>28 May 2026</strong> (Thursday)<br>
                    Bakrid
                </div>
                <div class="holiday-item">
                    <strong>14 September 2026</strong> (Monday)<br>
                    Ganesh Chaturthi
                </div>
                <div class="holiday-item">
                    <strong>02 October 2026</strong> (Friday)<br>
                    Gandhi Jayanti
                </div>
                <div class="holiday-item">
                    <strong>20 October 2026</strong> (Tuesday)<br>
                    Ayudha Puja / Mahanavami
                </div>
                <div class="holiday-item">
                    <strong>10 November 2026</strong> (Tuesday)<br>
                    Balipadyami / Deepavali
                </div>
                <div class="holiday-item">
                    <strong>25 December 2026</strong> (Friday)<br>
                    Christmas
                </div>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color planning"></div>
                <span>Yellow - Planning to be in Office</span>
            </div>
            <div class="legend-item">
                <div class="legend-color office"></div>
                <span>Green - Office Presence</span>
            </div>
            <div class="legend-item">
                <div class="legend-color leave"></div>
                <span>Pink - Leave/Sick Leave</span>
            </div>
            <div class="legend-item">
                <div class="legend-color travel"></div>
                <span>Blue - Traveling</span>
            </div>
            <div class="legend-item">
                <div class="legend-color weekend"></div>
                <span>Grey - Weekend</span>
            </div>
            <div class="legend-item">
                <div class="legend-color holiday"></div>
                <span>Dark Grey - Holiday (Non-changeable)</span>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä Comprehensive Attendance Report - 2026</h2>
                <span class="close" onclick="closeReportModal()">&times;</span>
            </div>
            <div id="reportContent">
                <!-- Report content will be generated here -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="export-btn" onclick="exportReportToCSV()">üì• Download Full Report (CSV)</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>